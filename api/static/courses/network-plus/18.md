# سرویس DHCP

سرویس DHCP (Dynamic Host Configuration Protocol) یک پروتکل شبکه است که در شبکه‌های کامپیوتری استفاده می‌شود تا به دستگاه‌ها (مانند کامپیوترها، تلفن‌ها، وای‌فای، و غیره) تنظیمات شبکه‌ای را اختصاص دهد. سرویس DHCP به طور خودکار و دینامیک آدرس IP، تنظیمات شبکه، و سایر اطلاعات شبکه را به دستگاه‌ها ارائه می‌دهد.

## تفاوت Static IP و Dynamic IP

- **Static IP**: وقتی یک دستگاه تنظیمات IP خود را به‌صورت استاتیک دارد، یک آدرس IP ثابت به آن اختصاص داده می‌شود. این آدرس IP همیشه ثابت می‌ماند و تغییر نمی‌کند. این نوع آدرس IP معمولاً برای دستگاه‌هایی استفاده می‌شود که نیاز به ثبات در شبکه دارند، مانند سرورها یا دستگاه‌های شبکه.

- **Dynamic IP**: در مقابل، وقتی یک دستگاه تنظیمات IP خود را به‌صورت دینامیک دارد، آدرس IP به طور خودکار توسط سرویس DHCP اختصاص داده می‌شود. هر بار که دستگاه به شبکه متصل می‌شود، DHCP سرور یک آدرس IP جدید به دستگاه اختصاص می‌دهد. این نوع آدرس IP برای دستگاه‌هایی استفاده می‌شود که نیاز به تغییر مکرر آدرس IP دارند، مانند کامپیوترهای رومیزی یا دستگاه‌های تلفن همراه.

## DHCP چیست و چرا از آن استفاده می‌کنیم

سرویس DHCP یک پروتکل شبکه است که استفاده می‌شود تا به دستگاه‌ها در شبکه تنظیمات شبکه را اختصاص دهد. DHCP سرور در شبکه وجود دارد و آدرس IP، تنظیمات DNS، دروازه پیش‌فرض و سایر پارامترهای شبکه را به دستگاه‌ها ارسال می‌کند. با استفاده از DHCP، نیازی به تنظیم دستی تنظیمات شبکه در هر دستگاهی که به شبکه متصل می‌شود، نیست و فرآیند تنظیمات شبکه به‌صورت خودکار انجام می‌شود.

از DHCP استفاده می‌شود تا:

- آدرس IP به دستگاه‌ها اختصاص داده شود.
- تنظیمات شبکه مانند DNS و دروازه پیش‌فرض به دستگاه‌ها ارسال شود.
- مدیریت آدرس IP و تنظیمات شبکه برای کاربران را ساده‌تر کند.
- اشتباهات تنظیمات شبکه را کاهش دهد و خطاهای انسانی را به حداقل برساند.

## مکانیزم کاری DHCP

مکانیزم کاری سرویس DHCP شامل مراحل زیر است:

1. **درخواست (DHCP Discover)**: وقتی یک دستگاه به شبکه متصل می‌شود و قصد دارد آدرس IP و سایر تنظیمات شبکه را دریافت کند، درخواست DHCP Discover را ارسال می‌کند. این درخواست برای پیدا کردن یک DHCP سرور در شبکه است.

2. **پاسخ (DHCP Offer)**: سپس، سرور DHCP که در شبکه وجود دارد، یک پاسخ DHCP Offer به دستگاه ارسال می‌کند. این پاسخ حاوی آدرس IP اختصاصی و سایر تنظیمات شبکه است که سرور به دستگاه ارائه می‌دهد.

3. **تایید (DHCP Request)**: پس از دریافت پاسخ DHCP Offer، دستگاه یک تایید DHCP Request ارسال می‌کند تا اعلام کند که آدرس IP و تنظیمات دریافت شده را قبول می‌کند.

4. **پذیرش (DHCP Acknowledge)**: در نهایت، سرور DHCP یک پاسخ پذیرش DHCP Acknowledge به دستگاه ارسال می‌کند تا تایید کند که تنظیمات شبکه به درستی به دستگاه ارائه شده است. از این پس، دستگاه می‌تواند از آدرس IP و سایر تنظیمات شبکه استفاده کند.

## Pool یا Scope در DHCP

در سرویس DHCP، یک Pool یا Scope محدوده‌ای از آدرس‌های IP تعریف می‌شود که DHCP سرور می‌تواند به دستگاه‌ها اختصاص دهد. این محدوده شامل یک یا چند زیرمجموعه از آدرس‌های IP است که برای استفاده در شبکه در نظر گرفته می‌شوند.

هنگامی که یک درخواست DHCP دریافت می‌شود، سرور DHCP یک آدرس IP از Pool مربوطه را به دستگاه اختصاص می‌دهد. این Pool معمولاً شامل آدرس‌های IP خالی است که هنوز به هیچ دستگاهی اختصاص داده نشده‌اند.

## منظور از Reservation در DHCP

در سرویس DHCP، Reservation یا رزرو به‌معنی اختصاص دادن یک آدرس IP خاص به یک دستگاه خاص است. وقتی یک رزرو برای یک دستگاه انجام می‌شود، DHCP سرور آدرس IP مشخصی را برای آن دستگاه رزرو می‌کند و از اختصاص آن به سایر دستگاه‌ها جلوگیری می‌کند.

این ویژگی معمولاً برای دستگاه‌هایی استفاده می‌شود که نیاز به آدرس IP ثابت دارند. با ایجاد رزرو، آدرس IP مشخصی به دستگاه اختصاص داده می‌شود و هر بار که دستگاه به شبکه متصل شود، همان آدرس IP را دریافت خواهد کرد.

## منظور از Exclusion در DHCP

Exclusion در سرویس DHCP به اختصاص دادن یا منع کردن استفاده از یک یا چند آدرس IP خاص در Pool یا Scope اشاره دارد. این آدرس‌ها از Pool خارج می‌شوند و برای تخصیص به دستگاه‌های دیگر در دسترس نیستند.

استفاده از Exclusion معمولاً برای اختصاص دادن آدرس‌های IP خاص به سرویس‌های شبکه مانند سرورها یا دستگاه‌های شبکه مورد استفاده قرار می‌گیرد. با این کار، اطمینان حاصل می‌شود که این آدرس‌ها به سایر دستگاه‌ها تخصیص داده نمی‌شوند.

## منظور از Lease Duration در DHCP

Lease Duration یا مدت اجاره در سرویس DHCP به مدت زمانی اشاره دارد که یک دستگاه می‌تواند از یک آدرس IP اختصاصی استفاده کند. وقتی یک آدرس IP به یک دستگاه اختصاص داده می‌شود، در واقع یک قرارداد (Lease) بین دستگاه و سرور DHCP برقرار می‌شود که تعیین می‌کند آدرس IP به مدت چه زمانی به دستگاه اجاره داده شده است.

در پایان مدت اجاره، دستگاه باید با سرور DHCP تماس بگیرد و برای تمدید اجاره آدرس IP درخواست کند. اگر درخواست تمدید در زمان مناسبی ارسال نشود، آدرس IP آزاد می‌شود و سرور می‌تواند آن را به دستگاه دیگری اختصاص دهد.

## منظور از Options در DHCP

Options یا گزینه‌ها در سرویس DHCP به تنظیمات دیگری اشاره دارد که در کنار آدرس IP، DNS و دروازه پیش‌فرض به دستگاه‌ها ارسال می‌شود. این تنظیمات برای تنظیمات شبکه اضافی و تنظیمات ویژه استفاده می‌شوند.

برخی از گزینه‌های معمول در سرویس DHCP شامل تنظیمات زیر هستند:

- **DNS Servers**: آدرس‌های IP سرورهای DNS

 که دستگاه باید از آن‌ها استفاده کند.
- **Domain Name**: نام دامنه که برای دستگاه تنظیم می‌شود.
- **Time Server**: آدرس IP سرور زمان که دستگاه باید از آن استفاده کند.
- **NetBIOS Name Servers**: آدرس‌های IP سرورهای NetBIOS که دستگاه باید استفاده کند.
- و غیره.

با ارسال این گزینه‌ها به دستگاه‌ها، تنظیمات شبکه بیشتری قابل تنظیم هستند و قابلیت‌های اضافی در شبکه فراهم می‌شوند.

## منظور از Relay Agent یا IP Helper

Relay Agent یا IP Helper یک سرویس یا دستگاه در شبکه است که وظیفهٔ روت کردن یا انتقال پیام‌های DHCP بین دستگاه‌های مختلف در شبکه را بر عهده دارد. وقتی یک درخواست DHCP از یک دستگاه به یک سرویس DHCP سرور ارسال می‌شود، Relay Agent این پیام را دریافت کرده و به سرویس DHCP سرور ارسال می‌کند. همچنین، پاسخ‌ها از سرویس DHCP سرور به دستگاه‌ها نیز توسط Relay Agent منتقل می‌شوند.

با استفاده از Relay Agent، امکان استفاده از سرویس DHCP در شبکه‌هایی که از چندین شبکه فیزیکی تشکیل شده‌اند، فراهم می‌شود. Relay Agent مسئول توزیع پیام‌های DHCP بین شبکه‌ها است و باعث سهولت در مدیریت سرویس DHCP در شبکه بزرگ‌تر می‌شود.

## منظور از Rogue DHCP

Rogue DHCP یا DHCP بدخواه، سرویس DHCP ناخواسته‌ای است که توسط یک دستگاه یا سرور غیرمجاز در شبکه راه‌اندازی می‌شود. Rogue DHCP به طور نامشخص ظاهر می‌شود و تلاش می‌کند تا به دستگاه‌های درخواست‌دهنده‌ای در شبکه آدرس IP و تنظیمات شبکه را اختصاص دهد.

استفاده از یک Rogue DHCP می‌تواند منجر به تداخل شبکه، اختلال در ارتباطات شبکه و از دست دادن اطلاعات حساس شود. به همین دلیل، Rogue DHCP باید شناسایی و حذف شود تا شبکه به‌طور صحیح عمل کند و تمام دستگاه‌ها تنظیمات شبکه را از سرویس DHCP معتبر دریافت کنند.